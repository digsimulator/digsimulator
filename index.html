<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>드릴 업그레이드 시스템</title>
 <style>
  /* 배경 및 기본 폰트 */
  body {
    background: linear-gradient(135deg, #74b9ff, #a29bfe);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 30px;
    display: flex;
    justify-content: center;
    gap: 30px;
    color: #2d3436;
    user-select: none;
  }

  /* 좌/중/우 패널 공통 스타일 */
  #left-panel, #center-panel, #right-panel {
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.12);
    padding: 25px 30px;
    display: flex;
    flex-direction: column;
  }

  #left-panel {
    width: 220px;
    gap: 30px;
  }

  #center-panel {
    width: 360px;
    align-items: center;
  }

  #right-panel {
    width: 700px;
  }

  /* 제목 */
  h1, h2 {
    font-weight: 700;
    margin: 0 0 25px 0;
    color: #0984e3;
    text-align: center;
    letter-spacing: 1px;
    font-size: 25px
  }

  /* 상태창 */
  #status {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 25px;
    color: #636e72;
    user-select: text;
  }

  /* 게임 영역 */
  #game {
    position: relative;
    width: 320px;
    height: 900px;
    border-radius: 15px;
    border: 3px solid #74b9ff;
    background: #dfe6e9;
    overflow-y: auto;
    overflow-x: hidden;
    box-shadow: inset 0 0 15px #b2bec3;
    scrollbar-width: thin;
    scrollbar-color: #74b9ff #dfe6e9;
  }
  #game::-webkit-scrollbar {
    width: 10px;
  }
  #game::-webkit-scrollbar-track {
    background: #dfe6e9;
    border-radius: 12px;
  }
  #game::-webkit-scrollbar-thumb {
    background-color: #74b9ff;
    border-radius: 12px;
  }

  /* 드릴 */
#drill {
  position: absolute;
  width: 0;
  height: 0;
  border-left: 30px solid transparent;
  border-right: 30px solid transparent;
  border-top: 60px solid #636e72; /* 삼각형 모양 드릴 */
  top: 50px;
  left: 130px;
  cursor: pointer;
  transition: transform 0.15s ease, box-shadow 0.15s ease;
  z-index: 10;
}

/* 애니메이션 추가 (선택) */
#drill:hover {
  transform: rotate(5deg) scale(1.05);
}

/* 부서졌을 때 효과 */
#drill.broken {
  border-top-color: #e74c3c;
  box-shadow: 0 0 20px red;
}

/*드릴 스킨임*/
#drill.skin-fire {
  border-top-color: orangered;
  filter: drop-shadow(0 0 10px orange);
  animation: fireGlow 1s infinite;
}

@keyframes fireGlow {
  0% { filter: drop-shadow(0 0 5px orange); }
  50% { filter: drop-shadow(0 0 15px red); }
  100% { filter: drop-shadow(0 0 5px orange); }
}

#drill.skin-ice {
  border-top-color: rgb(38, 111, 221);
  filter: drop-shadow(0 0 10px rgb(80, 189, 223));
  animation: fireGlow 1s infinite;
}

@keyframes fireGlow {
  0% { filter: drop-shadow(0 0 5px rgb)(38, 111, 221); }
  50% { filter: drop-shadow(0 0 15px rgb)(80, 189, 223); }
  100% { filter: drop-shadow(0 0 5px rgb)(38, 111, 221); }
}


  /* 땅 레이어 */
  #ground {
    position: relative;
    margin-top: 160px;
    width: 100%;
    border-radius: 0 0 15px 15px;
    overflow: hidden;
  }
  .layer {
    width: 100%;
    height: 40px;
    border-top: 1px solid #b2bec3;
    transition: background-color 0.4s ease;
  }
  .dirt { background: #a0522d; }
  .gravel { background: #636e72; }
  .stone { background: #2d3436; }
  .ice { background: rgb(52, 119, 173)}
  .destroyed { background: #b2bec3 !important; }
  .bedrock { background: #000 !important; }
  .broken { background: #c0392b !important; }

  /* 업그레이드 패널 */
  #upgrades {
    display: flex;
    flex-direction: column;
    gap: 25px;
  }
  .upgrade-block {
    display: flex;
    flex-direction: column;
    gap: 10px;
    background: #dfe6e9;
    padding: 18px 20px;
    border-radius: 15px;
    box-shadow: inset 0 0 10px #b2bec3;
    font-weight: 600;
    font-size: 15px;
    color: #2d3436;
  }

  /* 업그레이드 버튼 */
  button {
    padding: 14px 24px;
    font-size: 18px;
    font-weight: 700;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    background: linear-gradient(45deg, #0984e3, #74b9ff);
    color: white;
    box-shadow: 0 6px 16px rgba(9, 132, 227, 0.7);
    transition: background 0.3s ease, transform 0.2s ease;
  }
  button:hover:not(:disabled) {
    background: linear-gradient(45deg, #74b9ff, #0984e3);
    transform: scale(1.07);
  }
  button:disabled {
    background: #b2bec3;
    cursor: not-allowed;
    box-shadow: none;
    color: #636e72;
  }

  /* 업그레이드 요구사항 텍스트 */
  #powerUpgradeReq, #durabilityUpgradeReq {
    font-size: 15px;
    font-weight: 600;
    color: #0984e3;
    text-align: center;
  }

  /* 인벤토리 */
  #inventory {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    
    gap: 5px;
  }
  .inventory-slot {
    background: #f7f9fc;
    border-radius: 15px;
    border: 2px solid #74b9ff;
    height: 110px;
    width: 110px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 15px;
    font-weight: 600;
    color: #2d3436;
    box-shadow: 0 5px 14px rgba(116, 185, 255, 0.55);
    transition: background-color 0.3s ease;
    user-select: none;
  }
  .inventory-slot:hover {
    background-color: #dff1ff;
  }

  #encyclopedia-panel {
  margin-top: 30px;
  background: #f7f9fc;
  border-radius: 15px;
  padding: 20px;
  box-shadow: inset 0 0 10px #dfe6e9;
  font-size: 15px;
  color: #2d3436;
}

.material-entry {
  padding: 10px 8px;
  border-bottom: 1px solid #dcdde1;
  display: flex;
  justify-content: space-between;
  align-items: center;
}
.material-entry:last-child {
  border-bottom: none;
}

.material-name {
  font-weight: bold;
  font-size: 16px;
}

.material-info {
  font-size: 13px;
  color: #636e72;
}

/* 스킨 목록 전체 박스 */
#skin-list {
  display: flex;
  flex-direction: column;
  gap: 12px;
  margin-top: 10px;
}

/* 스킨 항목 */
.skin-item {
  display: flex;
  align-items: center;
  gap: 12px;
  font-weight: 600;
  font-size: 16px;
  cursor: pointer;
  padding: 8px 12px;
  border-radius: 10px;
  background: #dfe6e9;
  box-shadow: inset 0 0 8px #b2bec3;
  user-select: none;
  transition: background-color 0.3s ease;
}
.skin-item:hover {
  background-color: #c1d4ff;
}

/* 체크 표시 */
.skin-item .checkmark {
  width: 20px;
  height: 20px;
  background-color: #27ae60; /* 초록 */
  mask: url('data:image/svg+xml;utf8,<svg fill="white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6 10.793l-3.146-3.147-1.414 1.414L6 13.621l8-8-1.414-1.414z"/></svg>') no-repeat center;
  -webkit-mask: url('data:image/svg+xml;utf8,<svg fill="white" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M6 10.793l-3.146-3.147-1.414 1.414L6 13.621l8-8-1.414-1.414z"/></svg>') no-repeat center;
}


</style>

</head>
<body>

<div id="left-panel">
  <div id="upgrades">
    <div class="upgrade-block">
      <button onclick="upgradePower()">💪 강도 업그레이드</button>
      <div id="powerUpgradeReq"></div> <!-- 재료 표시 영역 -->
    </div>
    <div class="upgrade-block">
      <button onclick="upgradeDurability()">🛠 내구도 업그레이드</button>
      <div id="durabilityUpgradeReq"></div> <!-- 재료 표시 영역 -->
    </div>
    <div class="upgrade-block">
  <button onclick="openSkinShop()">🎨 드릴 스킨 상점</button>
</div>

<div id="skin-shop" style="display:none; margin-top: 20px;">
  <h2>🛍️ 스킨 상점</h2>
  <div class="upgrade-block">
    <p><strong>🔥 불꽃 스킨</strong><br>고대흙 x5, 루비 x5 엄청큰자갈 x1</p>
    <button onclick="buyDrillSkin('fire')">구매</button>
    <p><strong>🧊 얼음 스킨</strong><br>차가운얼음 x1, 따뜻한얼음 x1, 고드름 x1, 드라이아이스 x1, 눈송이 x1, 눈사람 x1</p>
    <button onclick="buyDrillSkin('ice')">구매</button>
  </div>
</div>



  </div>
</div>


<div id="center-panel">
  <h1>땅파기 시뮬 (Made by 범서)</h1>
  <h1>Ver 1.12 pre release</h1>
  <div id="status">
    내구도: <span id="durability">9</span> |
    강도: <span id="power">1</span> |
    💰: <span id="money">0</span>
  </div>
  <div id="game">
    <div id="drill"></div>
    <div id="ground"></div>
  </div>
</div>

<div id="right-panel">
  <h2>--- 인벤토리 ---</h2>
  <div id="inventory"></div>

        <div id="encyclopedia-panel">
  <h2>--- 최근 발견한 광물 정보 ---</h2>
  <div id="material-list"></div>
</div>

  <h2 style="margin-top: 40px;">🎨 드릴 스킨 목록</h2>
  <div id="skin-list"></div>
</div>

<script>
  const drill = document.getElementById("drill");
  const game = document.getElementById("game");
  const ground = document.getElementById("ground");
  const durabilityDisplay = document.getElementById("durability");
  const powerDisplay = document.getElementById("power");
  const moneyDisplay = document.getElementById("money");
  const inventoryUI = document.getElementById("inventory");
  const powerUpgradeReqUI = document.getElementById("powerUpgradeReq");
  const durabilityUpgradeReqUI = document.getElementById("durabilityUpgradeReq");
  const discoveredMaterials = new Set();


  const DRILL_SPEED = 2;
  const DRILL_HEIGHT = 60;
  let MAX_DURABILITY = 9;
  let drillPower = 1;
  let money = 0;
  let isFalling = false;
  let durability = MAX_DURABILITY;
  let layers = [];
  let inventory = [];
  let lastMinedMaterial = null;


  const MAX_STACK = 30;
  const INVENTORY_SIZE = 30;

  // 강도 업그레이드 단계별 정보 (레벨 0부터 시작)
  const DrillPowerUpgrades = [
    { name: "power1", powerAddition: 1, need: { 흙: 10, 부싯돌: 1 }, money: 10 },
    { name: "power2", powerAddition: 1, need: { 흙: 18, 부싯돌: 4, 고대흙: 1 }, money: 10 },
    { name: "power3", powerAddition: 2, need: { 흙: 24, 부싯돌: 8, 고대흙: 5, }, money: 50 },
    { name: "power4", powerAddition: 2, need: { 고대흙: 3, 자갈: 20, 석탄: 1}, money: 100 },
    { name: "power5", powerAddition: 3, need: { 자갈: 25, 석탄: 5, 은: 3, }, money: 200 },
    { name: "power6", powerAddition: 3, need: { 고대흙: 2, 자갈: 30, 석탄: 15, 은: 15, }, money: 300 },
    { name: "power7", powerAddition: 4, need: { 석탄: 20, 은: 20, 돌: 3, 철: 1}, money: 400 },




    // 필요한 만큼 추가 가능
  ];
  let currentPowerLevel = 0;


  // 내구도 업그레이드 단계별 정보
  const DurabilityUpgrades = [
    { name: "durability1", durabilityAddition: 9, money: 20 },
    { name: "durability2", durabilityAddition: 9, money: 50 },
    { name: "durability4", durabilityAddition: 12, money: 80 },
    { name: "durability3", durabilityAddition: 9, money: 240 },
    { name: "durability4", durabilityAddition: 12, money: 510 },
    { name: "durability4", durabilityAddition: 12, money: 700 },
    // 추가 가능
  ];
  let currentDurabilityLevel = 0;


  
  // 광물 드랍 확률
  const DropChances = {
    Dirt: [
      { item: "흙", chance: 0.7 },
      { item: "부싯돌", chance: 0.2 },
      { item: "고대흙", chance: 0.1 }
    ],
    Gravel: [
      { item: "자갈", chance: 0.74 },
      { item: "석탄", chance: 0.15 },
      { item: "은", chance: 0.1 },
      { item: "엄청큰자갈", chance: 0.01 },

    ],
    Stone: [
      { item: "돌", chance: 0.66 },
      { item: "철", chance: 0.15 },
      { item: "다이아몬드", chance: 0.11 },
      { item: "루비", chance: 0.08 }
    ],
    Ice: [
      { item: "차가운얼음", chance: 0.4 },
      { item: "따뜻한얼음", chance: 0.2 },
      { item: "고드름", chance: 0.125 },
      { item: "드라이아이스", chance: 0.1 },
      { item: "눈송이", chance: 0.075 },
      { item: "눈사람", chance: 0.05 }
    ]
    
  };

  // 광물 가격(돈 환산)
  const DigPrices = {
    흙: { materialName: "흙", diggedPrice: 1 },
    부싯돌: { materialName: "부싯돌", diggedPrice: 3 },
    고대흙: { materialName: "고대흙", diggedPrice: 7 },
    자갈: { materialName: "자갈", diggedPrice: 2 },
    석탄: { materialName: "석탄", diggedPrice: 4 },
    은: { materialName: "은", diggedPrice: 6 },
    돌: { materialName: "돌", diggedPrice: 2 },
    철: { materialName: "철", diggedPrice: 5 },
    다이아몬드: { materialName: "다이아몬드", diggedPrice: 10 },
    루비: { materialName: "루비", diggedPrice: 15 },
    엄청큰자갈: { materialName: "엄청큰자갈", diggedPrice: 2 },
    차가운얼음: { materialName: "차가운얼음", diiggedPrice: 5},
    따뜻한얼음: { materialName: "따뜻한얼음", diiggedPrice: 10},
    고드름: { materialName: "고드름", diiggedPrice: 15},
    드라이아이스: { materialName: "드라이아이스", diiggedPrice: 20},
    눈송이: { materialName: "눈송이", diiggedPrice: 30},
    눈사람: { materialName: "눈사람", diiggedPrice: 50}
  };

  // 광물 등장 시 인벤토리에 추가 및 돈 획득
  function addItemToInventory(item) {
    for (let slot of inventory) {
      if (slot.item === item && slot.count < MAX_STACK) {
        slot.count++;
        lastMinedMaterial = item;
        updateInventoryUI();
        if (DigPrices[item]) money += DigPrices[item].diggedPrice;
        updateUI();
        return;
      }
    }
    if (inventory.length < INVENTORY_SIZE) {
      inventory.push({ item, count: 1 });
      lastMinedMaterial = item;
      updateInventoryUI();
      if (!discoveredMaterials.has(item)) {
      discoveredMaterials.add(item);
      alert(`🌟 새로운 광물 발견: ${item}!`);
      renderMaterialEncyclopedia();
}

      if (DigPrices[item]) money += DigPrices[item].diggedPrice;
      updateUI();

    }
  }

  // 광물 드랍 확률 계산
  function getRandomDrop(type) {
    const drops = DropChances[type];
    const rand = Math.random();
    let total = 0;
    for (let drop of drops) {
      total += drop.chance;
      if (rand <= total) return drop.item;
    }
    return null;
  }

  // 지면 생성
  function createGround() {
    ground.innerHTML = "";
    layers = [];

    const totalLayers = [
      { count: 10, type: "Dirt", hp: 3 },
      { count: 30, type: "Gravel", hp: 5 },
      { count: 30, type: "Stone", hp: 9 },
      { count: 20, type: "Ice", hp: 20}
    ];

    totalLayers.forEach(({ count, type, hp }) => {
      for (let i = 0; i < count; i++) {
        const div = document.createElement("div");
        div.classList.add("layer", type.toLowerCase());
        div.dataset.hp = hp;
        div.dataset.type = type;
        ground.appendChild(div);
        layers.push(div);
      }
    });

    const bedrock = document.createElement("div");
    bedrock.classList.add("layer", "bedrock");
    bedrock.dataset.hp = "∞";
    ground.appendChild(bedrock);
    layers.push(bedrock);

    drill.style.top = "50px";
    game.scrollTop = 0;
    durability = MAX_DURABILITY;
    updateUI();
    drill.classList.remove("broken");
  }

    function updateUI() {
    durabilityDisplay.textContent = durability;
    powerDisplay.textContent = drillPower;
    moneyDisplay.textContent = money;

    if (currentPowerLevel < DrillPowerUpgrades.length) {
      const nextPower = DrillPowerUpgrades[currentPowerLevel];
      const needs = Object.entries(nextPower.need)
        .map(([k,v]) => `${k} x${v}`)
        .join(", ");
      powerUpgradeReqUI.textContent = `${needs}, 💰${nextPower.money}`;
    } else {
      powerUpgradeReqUI.textContent = "최대 레벨 달성";
    }

    if (currentDurabilityLevel < DurabilityUpgrades.length) {
      const nextDur = DurabilityUpgrades[currentDurabilityLevel];
      durabilityUpgradeReqUI.textContent = `💰${nextDur.money}`;
    } else {
      durabilityUpgradeReqUI.textContent = "최대 레벨 달성";
    }
  }
  // UI 업데이트 (내구도, 강도, 돈 및 업그레이드 버튼 텍스트)
function updateUI() {
  durabilityDisplay.textContent = durability;
  powerDisplay.textContent = drillPower;
  moneyDisplay.textContent = money;

  if (currentPowerLevel < DrillPowerUpgrades.length) {
    const nextPower = DrillPowerUpgrades[currentPowerLevel];
    const needs = Object.entries(nextPower.need)
      .map(([k,v]) => `${k} x${v}`)
      .join(", ");
    powerUpgradeReqUI.textContent = `${needs}, 💰${nextPower.money}`;
  } else {
    powerUpgradeReqUI.textContent = "최대 레벨 달성";
  }

  if (currentDurabilityLevel < DurabilityUpgrades.length) {
    const nextDur = DurabilityUpgrades[currentDurabilityLevel];
    durabilityUpgradeReqUI.textContent = `💰${nextDur.money}`;
  } else {
    durabilityUpgradeReqUI.textContent = "최대 레벨 달성";
  }
}

// 내구도 업그레이드 함수
function upgradeDurability() {
  if (currentDurabilityLevel >= DurabilityUpgrades.length) {
    alert("내구도 업그레이드는 최대 레벨입니다.");
    return;
  }
  const upgrade = DurabilityUpgrades[currentDurabilityLevel];

  if (money < upgrade.money) {
    alert(`돈이 부족합니다. 필요 금액: ${upgrade.money}`);
    return;
  }

  money -= upgrade.money;
  MAX_DURABILITY += upgrade.durabilityAddition;
  durability = MAX_DURABILITY;
  currentDurabilityLevel++;

  updateUI();
  alert(`내구도 +${upgrade.durabilityAddition}! 현재 내구도: ${MAX_DURABILITY}`);
}

  // 인벤토리 UI 업데이트
  function updateInventoryUI() {
  inventoryUI.innerHTML = "";
  for (let i = 0; i < INVENTORY_SIZE; i++) {
    const slot = document.createElement("div");
    slot.className = "inventory-slot";

    if (inventory[i]) {
      const { item, count } = inventory[i];
      slot.textContent = `${item} x${count}`;

      // 클릭 시 아이템 버리기
      slot.addEventListener("click", () => {
        if (confirm(`${item}을(를) 1개 버릴까요?`)) {
          inventory[i].count--;
          if (inventory[i].count <= 0) {
            inventory.splice(i, 1); // 슬롯 완전히 제거
          }
          updateInventoryUI();
        }
      });
    }

    inventoryUI.appendChild(slot);
  }
}


  // 드릴 떨어뜨리기 동작
  function dropDrill() {
    if (isFalling || durability <= 0) return;
    isFalling = true;
    let top = parseInt(drill.style.top);
    const fallInterval = setInterval(() => {
      top += DRILL_SPEED;
      drill.style.top = `${top}px`;
      game.scrollTop = Math.max(0, top - 400);
      const drillBottom = top + DRILL_HEIGHT;
      for (let i = 0; i < layers.length; i++) {
        const layer = layers[i];
        const layerTop = ground.offsetTop + i * 40;
        const layerBottom = layerTop + 40;

        if (!layer.classList.contains("destroyed") && drillBottom >= layerTop && drillBottom <= layerBottom + 5) {
          let hp = layer.dataset.hp === "∞" ? Infinity : parseInt(layer.dataset.hp);
          if (hp !== Infinity) {
            hp -= drillPower;
            layer.dataset.hp = hp;
            if (hp <= 0) {
              layer.classList.add("destroyed");
              const drop = getRandomDrop(layer.dataset.type);
              if (drop) addItemToInventory(drop);
            }
          }

          durability--;
          updateUI();
          clearInterval(fallInterval);

          let bounce = 0;
          const bounceInterval = setInterval(() => {
            if (bounce < 5) {
              top -= 5;
              bounce++;
              drill.style.top = `${top}px`;
              game.scrollTop = Math.max(0, top - 400);
            } else {
              clearInterval(bounceInterval);
              isFalling = false;
              if (durability <= 0) drillBroken();
            }
          }, 20);
          return;
        }
      }

      if (top >= game.scrollHeight - DRILL_HEIGHT) {
        clearInterval(fallInterval);
        isFalling = false;
      }
    }, 20);
  }

  // 드릴 부서짐 처리
  function drillBroken() {
    drill.classList.add("broken");
    alert("💥 드릴이 부서졌습니다! 땅이 복구됩니다.");
    setTimeout(() => {
      createGround();
    }, 1000);
  }

  // 강도 업그레이드 함수 (단계별 조건 검사 및 실행)
  function upgradePower() {
    if (currentPowerLevel >= DrillPowerUpgrades.length) {
      alert("강도 업그레이드는 최대 레벨입니다.");
      return;
    }
    const upgrade = DrillPowerUpgrades[currentPowerLevel];

    // 재료 검사
    for (const itemName in upgrade.need) {
      const requiredCount = upgrade.need[itemName];
      const invItem = inventory.find(i => i.item === itemName);
      if (!invItem || invItem.count < requiredCount) {
        alert(`재료 부족: ${itemName} x${requiredCount}`);
        return;
      }
    }
    // 돈 검사
    if (money < upgrade.money) {
      alert(`돈이 부족합니다. 필요 금액: ${upgrade.money}`);
      return;
    }

    // 재료 차감
    for (const itemName in upgrade.need) {
      const requiredCount = upgrade.need[itemName];
      const invItem = inventory.find(i => i.item === itemName);
      invItem.count -= requiredCount;
      if (invItem.count <= 0) {
        inventory = inventory.filter(i => i.count > 0);
      }
    }
    money -= upgrade.money;

    // 강도 증가
    drillPower += upgrade.powerAddition;
    currentPowerLevel++;

    updateInventoryUI();
    updateUI();
    alert(`드릴 강도 +${upgrade.powerAddition}! 현재 강도: ${drillPower}`);
  }

  // 내구도 업그레이드 함수 (단계별 조건 검사 및 실행)
  function upgradeDurability() {
    if (currentDurabilityLevel >= DurabilityUpgrades.length) {
      alert("내구도 업그레이드는 최대 레벨입니다.");
      return;
    }
    const upgrade = DurabilityUpgrades[currentDurabilityLevel];

    // 돈 검사
    if (money < upgrade.money) {
      alert(`돈이 부족합니다. 필요 금액: ${upgrade.money}`);
      return;
    }

    money -= upgrade.money;
    MAX_DURABILITY += upgrade.durabilityAddition;
    durability = MAX_DURABILITY;
    currentDurabilityLevel++;

    updateUI();
    alert(`내구도 +${upgrade.durabilityAddition}! 현재 내구도: ${MAX_DURABILITY}`);
  }

  drill.addEventListener("click", dropDrill);

  createGround();
  updateUI();

  const materialData = {
  흙: {
    description: "가장 흔한 재료입니다.",
    rarity: "★"
  },
  부싯돌: {
    description: "흙에서 낮은 확률로 나오는 돌.",
    rarity: "★★"
  },
  고대흙: {
    description: "시간이 멈춘 듯한 흙.",
    rarity: "★★★"
  },
  자갈: {
    description: "흔한 자갈 부싯돌보단 딱딱.",
    rarity: "★"
  },
  석탄: {
    description: "자갈보다 자주 쓰이는 돌덩이.",
    rarity: "★★"
  },
  은: {
    description: "반짝이고 비싼 조각",
    rarity: "★★★"
  },
  돌: {
    description: "단단한 돌. 다른 광물보다 튼튼해보임",
    rarity: "★"
  },
  철: {
    description: "강한 재료. 돌보다 단단",
    rarity: "★★★"
  },
  다이아몬드: {
    description: "반짝이면서도 철보다 단단한 광물.",
    rarity: "★★★★"
  },
  루비: {
    description: "붉은 다이아몬드. 고급져보임",
    rarity: "★★★★★"
  },
  엄청큰자갈: {
    description: "그냥 큰 자갈 매우 희귀하다.",
    rarity: "★★★★★★"
  },
   차가운얼음: {
    description: "말 그대로 차가운 얼음.",
    rarity: "★★★"
  },
   따뜻한얼음: {
    description: "말 그대호 따뜻한 얼음.",
    rarity: "★★★★"
  },
   고드름: {
    description: "그냥 큰 자갈 매우 희귀하다.",
    rarity: "★★★★"
  },
   드라이아이스: {
    description: "그냥 큰 자갈 매우 희귀하다.",
    rarity: "★★★★★"
  },
   눈송이: {
    description: "그냥 큰 자갈 매우 희귀하다.",
    rarity: "★★★★★★"
  },
   눈사람: {
    description: "그냥 큰 자갈 매우 희귀하다.",
    rarity: "★★★★★★"
  },
  

};

//최근 광물 정보 표시
function renderMaterialEncyclopedia() {
  const list = document.getElementById("material-list");
  list.innerHTML = "";

  if (lastMinedMaterial && materialData[lastMinedMaterial]) {
    const data = materialData[lastMinedMaterial];
    const div = document.createElement("div");
    div.className = "material-entry";
    div.innerHTML = `
      <div>
        <div class="material-name">${lastMinedMaterial}</div>
        <div class="material-info">${data.description}</div>
      </div>
      <div class="material-info">희귀도: ${data.rarity}</div>
    `;
    list.appendChild(div);
  }
}




// =============================
// 드릴 스킨 샵 열기
// =============================
function openSkinShop() {
  const shop = document.getElementById("skin-shop");
  shop.style.display = shop.style.display === "none" ? "block" : "none";
}

// =============================
// 현재 스킨 상태 및 보유 목록
// =============================
let ownedSkins = ["none"]; // 항상 기본 스킨 소유
let currentSkin = "none";

// =============================
// 모든 스킨 목록
// =============================
const availableSkins = [
  { id: "none", name: "기본 스킨" },
  { id: "fire", name: "🔥 불꽃 스킨" },
  { id: "ice", name: "❄️ 얼음 스킨" },
];

// =============================
// 드릴에 스킨 적용
// =============================
function applyDrillSkin(skinId) {
  currentSkin = skinId;

  const drill = document.getElementById("drill");
  if (!drill) return;

  drill.className = "drill";
  if (skinId !== "none") {
    drill.classList.add("skin-" + skinId);
  }

  renderSkinList();
}

// =============================
// 스킨 샵 목록 렌더링
// =============================
function renderSkinList() {
  const skinList = document.getElementById("skin-list");
  skinList.innerHTML = "";

  for (const skin of availableSkins) {
    const div = document.createElement("div");
    div.className = "skin-item";
    div.textContent = skin.name;

    // 구매 여부에 따라 스타일 조정
    if (!ownedSkins.includes(skin.id)) {
      div.style.opacity = 0.5;
      div.style.cursor = "not-allowed";
    } else {
      div.addEventListener("click", () => {
        applyDrillSkin(skin.id);
      });
    }

    // 체크마크
    if (skin.id === currentSkin) {
      const check = document.createElement("div");
      check.className = "checkmark";
      div.appendChild(check);
    }

    skinList.appendChild(div);
  }
}

// =============================
// 스킨 구매 처리
// =============================
function buyDrillSkin(skinName) {
  const skinRequirements = {
    fire: { 엄청큰자갈: 1 ,고대흙: 5 ,루비: 5 },
    ice: { 차가운얼음: 1, 따뜻한얼음: 1, 고드름: 1, 드라이아이스: 1, 눈송이: 1, 눈사람: 1 },
  };

  const skinMessages = {
    fire: "🔥 불꽃 드릴 스킨이 구매되고 적용되었습니다!",
    ice: "🧊 얼음 드릴 스킨이 구매되고 적용되었습니다!",
  };

  const need = skinRequirements[skinName];
  if (!need) {
    alert("존재하지 않는 스킨입니다.");
    return;
  }

  // 재료 확인
  for (const [item, count] of Object.entries(need)) {
    const found = inventory.find(i => i.item === item);
    if (!found || found.count < count) {
      alert(`${item}이(가) 부족합니다.`);
      return;
    }
  }

  // 재료 차감
  for (const [item, count] of Object.entries(need)) {
    const found = inventory.find(i => i.item === item);
    found.count -= count;
    if (found.count <= 0) {
      inventory = inventory.filter(i => i.count > 0);
    }
  }

  updateInventoryUI();

  // 보유 목록에 추가
  if (!ownedSkins.includes(skinName)) {
    ownedSkins.push(skinName);
  }

  // 적용
  applyDrillSkin(skinName);
  alert(skinMessages[skinName]);
  renderSkinList();
  renderMaterialEncyclopedia?.(); // 있으면 실행
}

function destroyDrill() {
  alert("드릴이 파괴되었습니다! 땅이 복구됩니다.");
  // 모바일이면 숨기지 않도록
  if (window.innerWidth > 768) {
    document.querySelector('#left-panel').style.display = 'none';
  }
  setTimeout(() => {
    createGround();
    document.querySelector('#left-panel').style.display = '';
  }, 1000);
}



</script>

</body>
</html>
