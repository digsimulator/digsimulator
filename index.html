<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <title>ë“œë¦´ ì—…ê·¸ë ˆì´ë“œ ì‹œìŠ¤í…œ</title>
 <style>
  /* ë°°ê²½ ë° ê¸°ë³¸ í°íŠ¸ */
  body {
    background: linear-gradient(135deg, #74b9ff, #a29bfe);
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 30px;
    display: flex;
    justify-content: center;
    gap: 30px;
    color: #2d3436;
    user-select: none;
  }

  /* ì¢Œ/ì¤‘/ìš° íŒ¨ë„ ê³µí†µ ìŠ¤íƒ€ì¼ */
  #left-panel, #center-panel, #right-panel {
    background: #fff;
    border-radius: 15px;
    box-shadow: 0 8px 20px rgba(0,0,0,0.12);
    padding: 25px 30px;
    display: flex;
    flex-direction: column;
  }

  #left-panel {
    width: 220px;
    gap: 30px;
  }

  #center-panel {
    width: 360px;
    align-items: center;
  }

  #right-panel {
    width: 700px;
  }

  /* ì œëª© */
  h1, h2 {
    font-weight: 700;
    margin: 0 0 25px 0;
    color: #0984e3;
    text-align: center;
    letter-spacing: 1px;
    font-size: 25px
  }

  /* ìƒíƒœì°½ */
  #status {
    font-size: 20px;
    font-weight: 600;
    margin-bottom: 25px;
    color: #636e72;
    user-select: text;
  }

  /* ê²Œì„ ì˜ì—­ */
  #game {
    position: relative;
    width: 320px;
    height: 900px;
    border-radius: 15px;
    border: 3px solid #74b9ff;
    background: #dfe6e9;
    overflow-y: auto;
    overflow-x: hidden;
    box-shadow: inset 0 0 15px #b2bec3;
    scrollbar-width: thin;
    scrollbar-color: #74b9ff #dfe6e9;
  }
  #game::-webkit-scrollbar {
    width: 10px;
  }
  #game::-webkit-scrollbar-track {
    background: #dfe6e9;
    border-radius: 12px;
  }
  #game::-webkit-scrollbar-thumb {
    background-color: #74b9ff;
    border-radius: 12px;
  }

  /* ë“œë¦´ */
  #drill {
    position: absolute;
    width: 60px;
    height: 60px;
    background: linear-gradient(145deg, #636e72, #2d3436);
    border-radius: 50%;
    text-align: center;
    line-height: 60px;
    font-weight: 900;
    color: white;
    top: 50px;
    left: 130px;
    cursor: pointer;
    box-shadow: 0 6px 15px rgba(0,0,0,0.45);
    transition: transform 0.15s ease, box-shadow 0.15s ease;
    user-select: none;
    z-index: 10;
  }
  #drill:hover {
    transform: scale(1.15);
    box-shadow: 0 10px 25px rgba(0,0,0,0.65);
  }
  #drill.broken {
    background: linear-gradient(145deg, #c0392b, #e74c3c);
    box-shadow: 0 0 20px #e74c3c;
  }

  /* ë•… ë ˆì´ì–´ */
  #ground {
    position: relative;
    margin-top: 160px;
    width: 100%;
    border-radius: 0 0 15px 15px;
    overflow: hidden;
  }
  .layer {
    width: 100%;
    height: 40px;
    border-top: 1px solid #b2bec3;
    transition: background-color 0.4s ease;
  }
  .dirt { background: #a0522d; }
  .gravel { background: #636e72; }
  .stone { background: #2d3436; }
  .destroyed { background: #b2bec3 !important; }
  .bedrock { background: #000 !important; }
  .broken { background: #c0392b !important; }

  /* ì—…ê·¸ë ˆì´ë“œ íŒ¨ë„ */
  #upgrades {
    display: flex;
    flex-direction: column;
    gap: 25px;
  }
  .upgrade-block {
    display: flex;
    flex-direction: column;
    gap: 10px;
    background: #dfe6e9;
    padding: 18px 20px;
    border-radius: 15px;
    box-shadow: inset 0 0 10px #b2bec3;
    font-weight: 600;
    font-size: 15px;
    color: #2d3436;
  }

  /* ì—…ê·¸ë ˆì´ë“œ ë²„íŠ¼ */
  button {
    padding: 14px 24px;
    font-size: 18px;
    font-weight: 700;
    border: none;
    border-radius: 12px;
    cursor: pointer;
    background: linear-gradient(45deg, #0984e3, #74b9ff);
    color: white;
    box-shadow: 0 6px 16px rgba(9, 132, 227, 0.7);
    transition: background 0.3s ease, transform 0.2s ease;
  }
  button:hover:not(:disabled) {
    background: linear-gradient(45deg, #74b9ff, #0984e3);
    transform: scale(1.07);
  }
  button:disabled {
    background: #b2bec3;
    cursor: not-allowed;
    box-shadow: none;
    color: #636e72;
  }

  /* ì—…ê·¸ë ˆì´ë“œ ìš”êµ¬ì‚¬í•­ í…ìŠ¤íŠ¸ */
  #powerUpgradeReq, #durabilityUpgradeReq {
    font-size: 15px;
    font-weight: 600;
    color: #0984e3;
    text-align: center;
  }

  /* ì¸ë²¤í† ë¦¬ */
  #inventory {
    display: grid;
    grid-template-columns: repeat(6, 1fr);
    
    gap: 5px;
  }
  .inventory-slot {
    background: #f7f9fc;
    border-radius: 15px;
    border: 2px solid #74b9ff;
    height: 110px;
    width: 110px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 15px;
    font-weight: 600;
    color: #2d3436;
    box-shadow: 0 5px 14px rgba(116, 185, 255, 0.55);
    transition: background-color 0.3s ease;
    user-select: none;
  }
  .inventory-slot:hover {
    background-color: #dff1ff;
  }
</style>

</head>
<body>

<div id="left-panel">
  <div id="upgrades">
    <div class="upgrade-block">
      <button onclick="upgradePower()">ğŸ’ª ê°•ë„ ì—…ê·¸ë ˆì´ë“œ</button>
      <div id="powerUpgradeReq"></div> <!-- ì¬ë£Œ í‘œì‹œ ì˜ì—­ -->
    </div>
    <div class="upgrade-block">
      <button onclick="upgradeDurability()">ğŸ›  ë‚´êµ¬ë„ ì—…ê·¸ë ˆì´ë“œ</button>
      <div id="durabilityUpgradeReq"></div> <!-- ì¬ë£Œ í‘œì‹œ ì˜ì—­ -->
    </div>
  </div>
</div>


<div id="center-panel">
  <h1>ë•…íŒŒê¸° ì‹œë®¬ (Made by ë²”ì„œ)</h1>
  <h1>Ver 1.12 pre release</h1>
  <div id="status">
    ë‚´êµ¬ë„: <span id="durability">9</span> |
    ê°•ë„: <span id="power">1</span> |
    ğŸ’°: <span id="money">0</span>
  </div>
  <div id="game">
    <div id="drill">ğŸ”©</div>
    <div id="ground"></div>
  </div>
</div>

<div id="right-panel">
  <h2>--- ì¸ë²¤í† ë¦¬ ---</h2>
  <div id="inventory"></div>
</div>

<script>
  const drill = document.getElementById("drill");
  const game = document.getElementById("game");
  const ground = document.getElementById("ground");
  const durabilityDisplay = document.getElementById("durability");
  const powerDisplay = document.getElementById("power");
  const moneyDisplay = document.getElementById("money");
  const inventoryUI = document.getElementById("inventory");
  const powerUpgradeReqUI = document.getElementById("powerUpgradeReq");
  const durabilityUpgradeReqUI = document.getElementById("durabilityUpgradeReq");

  const DRILL_SPEED = 2;
  const DRILL_HEIGHT = 50;
  let MAX_DURABILITY = 9;
  let drillPower = 1;
  let money = 0;
  let isFalling = false;
  let durability = MAX_DURABILITY;
  let layers = [];
  let inventory = [];

  const MAX_STACK = 10;
  const INVENTORY_SIZE = 30;

  // ê°•ë„ ì—…ê·¸ë ˆì´ë“œ ë‹¨ê³„ë³„ ì •ë³´ (ë ˆë²¨ 0ë¶€í„° ì‹œì‘)
  const DrillPowerUpgrades = [
    { name: "power1", powerAddition: 1, need: { í™: 10, ë¶€ì‹¯ëŒ: 1 }, money: 10 },
    { name: "power2", powerAddition: 3, need: { í™: 20, ë¶€ì‹¯ëŒ: 5, ê³ ëŒ€í™: 1, }, money: 30 },
    { name: "power3", powerAddition: 3, need: { ê³ ëŒ€í™: 3, ìê°ˆ: 20, ì„íƒ„: 1}, money: 1 },
    // í•„ìš”í•œ ë§Œí¼ ì¶”ê°€ ê°€ëŠ¥
  ];
  let currentPowerLevel = 0;


  // ë‚´êµ¬ë„ ì—…ê·¸ë ˆì´ë“œ ë‹¨ê³„ë³„ ì •ë³´
  const DurabilityUpgrades = [
    { name: "durability1", durabilityAddition: 9, money: 20 },
    { name: "durability2", durabilityAddition: 9, money: 100 },
    // ì¶”ê°€ ê°€ëŠ¥
  ];
  let currentDurabilityLevel = 0;


  
  // ê´‘ë¬¼ ë“œë í™•ë¥ 
  const DropChances = {
    Dirt: [
      { item: "í™", chance: 0.7 },
      { item: "ë¶€ì‹¯ëŒ", chance: 0.2 },
      { item: "ê³ ëŒ€í™", chance: 0.1 }
    ],
    Gravel: [
      { item: "ìê°ˆ", chance: 0.6 },
      { item: "ì„íƒ„", chance: 0.25 },
      { item: "ì€", chance: 0.15 }
    ],
    Stone: [
      { item: "ëŒ", chance: 0.6 },
      { item: "ì² ", chance: 0.2 },
      { item: "ë‹¤ì´ì•„ëª¬ë“œ", chance: 0.1 },
      { item: "ë£¨ë¹„", chance: 0.1 }
    ]
  };

  // ê´‘ë¬¼ ê°€ê²©(ëˆ í™˜ì‚°)
  const DigPrices = {
    í™: { materialName: "í™", diggedPrice: 1 },
    ë¶€ì‹¯ëŒ: { materialName: "ë¶€ì‹¯ëŒ", diggedPrice: 3 },
    ê³ ëŒ€í™: { materialName: "ê³ ëŒ€í™", diggedPrice: 7 },
    ìê°ˆ: { materialName: "ìê°ˆ", diggedPrice: 2 },
    ì„íƒ„: { materialName: "ì„íƒ„", diggedPrice: 4 },
    ì€: { materialName: "ì€", diggedPrice: 6 },
    ëŒ: { materialName: "ëŒ", diggedPrice: 2 },
    ì² : { materialName: "ì² ", diggedPrice: 5 },
    ë‹¤ì´ì•„ëª¬ë“œ: { materialName: "ë‹¤ì´ì•„ëª¬ë“œ", diggedPrice: 10 },
    ë£¨ë¹„: { materialName: "ë£¨ë¹„", diggedPrice: 15 }
  };

  // ê´‘ë¬¼ ë“±ì¥ ì‹œ ì¸ë²¤í† ë¦¬ì— ì¶”ê°€ ë° ëˆ íšë“
  function addItemToInventory(item) {
    for (let slot of inventory) {
      if (slot.item === item && slot.count < MAX_STACK) {
        slot.count++;
        updateInventoryUI();
        if (DigPrices[item]) money += DigPrices[item].diggedPrice;
        updateUI();
        return;
      }
    }
    if (inventory.length < INVENTORY_SIZE) {
      inventory.push({ item, count: 1 });
      updateInventoryUI();
      if (DigPrices[item]) money += DigPrices[item].diggedPrice;
      updateUI();
    }
  }

  // ê´‘ë¬¼ ë“œë í™•ë¥  ê³„ì‚°
  function getRandomDrop(type) {
    const drops = DropChances[type];
    const rand = Math.random();
    let total = 0;
    for (let drop of drops) {
      total += drop.chance;
      if (rand <= total) return drop.item;
    }
    return null;
  }

  // ì§€ë©´ ìƒì„±
  function createGround() {
    ground.innerHTML = "";
    layers = [];

    const totalLayers = [
      { count: 10, type: "Dirt", hp: 3 },
      { count: 30, type: "Gravel", hp: 5 },
      { count: 30, type: "Stone", hp: 7 }
    ];

    totalLayers.forEach(({ count, type, hp }) => {
      for (let i = 0; i < count; i++) {
        const div = document.createElement("div");
        div.classList.add("layer", type.toLowerCase());
        div.dataset.hp = hp;
        div.dataset.type = type;
        ground.appendChild(div);
        layers.push(div);
      }
    });

    const bedrock = document.createElement("div");
    bedrock.classList.add("layer", "bedrock");
    bedrock.dataset.hp = "âˆ";
    ground.appendChild(bedrock);
    layers.push(bedrock);

    drill.style.top = "50px";
    game.scrollTop = 0;
    durability = MAX_DURABILITY;
    updateUI();
    drill.classList.remove("broken");
  }

    function updateUI() {
    durabilityDisplay.textContent = durability;
    powerDisplay.textContent = drillPower;
    moneyDisplay.textContent = money;

    if (currentPowerLevel < DrillPowerUpgrades.length) {
      const nextPower = DrillPowerUpgrades[currentPowerLevel];
      const needs = Object.entries(nextPower.need)
        .map(([k,v]) => `${k} x${v}`)
        .join(", ");
      powerUpgradeReqUI.textContent = `${needs}, ğŸ’°${nextPower.money}`;
    } else {
      powerUpgradeReqUI.textContent = "ìµœëŒ€ ë ˆë²¨ ë‹¬ì„±";
    }

    if (currentDurabilityLevel < DurabilityUpgrades.length) {
      const nextDur = DurabilityUpgrades[currentDurabilityLevel];
      durabilityUpgradeReqUI.textContent = `ğŸ’°${nextDur.money}`;
    } else {
      durabilityUpgradeReqUI.textContent = "ìµœëŒ€ ë ˆë²¨ ë‹¬ì„±";
    }
  }
  // UI ì—…ë°ì´íŠ¸ (ë‚´êµ¬ë„, ê°•ë„, ëˆ ë° ì—…ê·¸ë ˆì´ë“œ ë²„íŠ¼ í…ìŠ¤íŠ¸)
function updateUI() {
  durabilityDisplay.textContent = durability;
  powerDisplay.textContent = drillPower;
  moneyDisplay.textContent = money;

  if (currentPowerLevel < DrillPowerUpgrades.length) {
    const nextPower = DrillPowerUpgrades[currentPowerLevel];
    const needs = Object.entries(nextPower.need)
      .map(([k,v]) => `${k} x${v}`)
      .join(", ");
    powerUpgradeReqUI.textContent = `${needs}, ğŸ’°${nextPower.money}`;
  } else {
    powerUpgradeReqUI.textContent = "ìµœëŒ€ ë ˆë²¨ ë‹¬ì„±";
  }

  if (currentDurabilityLevel < DurabilityUpgrades.length) {
    const nextDur = DurabilityUpgrades[currentDurabilityLevel];
    durabilityUpgradeReqUI.textContent = `ğŸ’°${nextDur.money}`;
  } else {
    durabilityUpgradeReqUI.textContent = "ìµœëŒ€ ë ˆë²¨ ë‹¬ì„±";
  }
}

// ë‚´êµ¬ë„ ì—…ê·¸ë ˆì´ë“œ í•¨ìˆ˜
function upgradeDurability() {
  if (currentDurabilityLevel >= DurabilityUpgrades.length) {
    alert("ë‚´êµ¬ë„ ì—…ê·¸ë ˆì´ë“œëŠ” ìµœëŒ€ ë ˆë²¨ì…ë‹ˆë‹¤.");
    return;
  }
  const upgrade = DurabilityUpgrades[currentDurabilityLevel];

  if (money < upgrade.money) {
    alert(`ëˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤. í•„ìš” ê¸ˆì•¡: ${upgrade.money}`);
    return;
  }

  money -= upgrade.money;
  MAX_DURABILITY += upgrade.durabilityAddition;
  durability = MAX_DURABILITY;
  currentDurabilityLevel++;

  updateUI();
  alert(`ë‚´êµ¬ë„ +${upgrade.durabilityAddition}! í˜„ì¬ ë‚´êµ¬ë„: ${MAX_DURABILITY}`);
}

  // ì¸ë²¤í† ë¦¬ UI ì—…ë°ì´íŠ¸
  function updateInventoryUI() {
    inventoryUI.innerHTML = "";
    for (let i = 0; i < INVENTORY_SIZE; i++) {
      const slot = document.createElement("div");
      slot.className = "inventory-slot";
      if (inventory[i]) {
        slot.textContent = `${inventory[i].item} x${inventory[i].count}`;
      }
      inventoryUI.appendChild(slot);
    }
  }

  // ë“œë¦´ ë–¨ì–´ëœ¨ë¦¬ê¸° ë™ì‘
  function dropDrill() {
    if (isFalling || durability <= 0) return;
    isFalling = true;
    let top = parseInt(drill.style.top);
    const fallInterval = setInterval(() => {
      top += DRILL_SPEED;
      drill.style.top = `${top}px`;
      game.scrollTop = Math.max(0, top - 400);
      const drillBottom = top + DRILL_HEIGHT;
      for (let i = 0; i < layers.length; i++) {
        const layer = layers[i];
        const layerTop = ground.offsetTop + i * 40;
        const layerBottom = layerTop + 40;

        if (!layer.classList.contains("destroyed") && drillBottom >= layerTop && drillBottom <= layerBottom + 5) {
          let hp = layer.dataset.hp === "âˆ" ? Infinity : parseInt(layer.dataset.hp);
          if (hp !== Infinity) {
            hp -= drillPower;
            layer.dataset.hp = hp;
            if (hp <= 0) {
              layer.classList.add("destroyed");
              const drop = getRandomDrop(layer.dataset.type);
              if (drop) addItemToInventory(drop);
            }
          }

          durability--;
          updateUI();
          clearInterval(fallInterval);

          let bounce = 0;
          const bounceInterval = setInterval(() => {
            if (bounce < 5) {
              top -= 5;
              bounce++;
              drill.style.top = `${top}px`;
              game.scrollTop = Math.max(0, top - 400);
            } else {
              clearInterval(bounceInterval);
              isFalling = false;
              if (durability <= 0) drillBroken();
            }
          }, 20);
          return;
        }
      }

      if (top >= game.scrollHeight - DRILL_HEIGHT) {
        clearInterval(fallInterval);
        isFalling = false;
      }
    }, 20);
  }

  // ë“œë¦´ ë¶€ì„œì§ ì²˜ë¦¬
  function drillBroken() {
    drill.classList.add("broken");
    alert("ğŸ’¥ ë“œë¦´ì´ ë¶€ì„œì¡ŒìŠµë‹ˆë‹¤! ë•…ì´ ë³µêµ¬ë©ë‹ˆë‹¤.");
    setTimeout(() => {
      createGround();
    }, 1000);
  }

  // ê°•ë„ ì—…ê·¸ë ˆì´ë“œ í•¨ìˆ˜ (ë‹¨ê³„ë³„ ì¡°ê±´ ê²€ì‚¬ ë° ì‹¤í–‰)
  function upgradePower() {
    if (currentPowerLevel >= DrillPowerUpgrades.length) {
      alert("ê°•ë„ ì—…ê·¸ë ˆì´ë“œëŠ” ìµœëŒ€ ë ˆë²¨ì…ë‹ˆë‹¤.");
      return;
    }
    const upgrade = DrillPowerUpgrades[currentPowerLevel];

    // ì¬ë£Œ ê²€ì‚¬
    for (const itemName in upgrade.need) {
      const requiredCount = upgrade.need[itemName];
      const invItem = inventory.find(i => i.item === itemName);
      if (!invItem || invItem.count < requiredCount) {
        alert(`ì¬ë£Œ ë¶€ì¡±: ${itemName} x${requiredCount}`);
        return;
      }
    }
    // ëˆ ê²€ì‚¬
    if (money < upgrade.money) {
      alert(`ëˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤. í•„ìš” ê¸ˆì•¡: ${upgrade.money}`);
      return;
    }

    // ì¬ë£Œ ì°¨ê°
    for (const itemName in upgrade.need) {
      const requiredCount = upgrade.need[itemName];
      const invItem = inventory.find(i => i.item === itemName);
      invItem.count -= requiredCount;
      if (invItem.count <= 0) {
        inventory = inventory.filter(i => i.count > 0);
      }
    }
    money -= upgrade.money;

    // ê°•ë„ ì¦ê°€
    drillPower += upgrade.powerAddition;
    currentPowerLevel++;

    updateInventoryUI();
    updateUI();
    alert(`ë“œë¦´ ê°•ë„ +${upgrade.powerAddition}! í˜„ì¬ ê°•ë„: ${drillPower}`);
  }

  // ë‚´êµ¬ë„ ì—…ê·¸ë ˆì´ë“œ í•¨ìˆ˜ (ë‹¨ê³„ë³„ ì¡°ê±´ ê²€ì‚¬ ë° ì‹¤í–‰)
  function upgradeDurability() {
    if (currentDurabilityLevel >= DurabilityUpgrades.length) {
      alert("ë‚´êµ¬ë„ ì—…ê·¸ë ˆì´ë“œëŠ” ìµœëŒ€ ë ˆë²¨ì…ë‹ˆë‹¤.");
      return;
    }
    const upgrade = DurabilityUpgrades[currentDurabilityLevel];

    // ëˆ ê²€ì‚¬
    if (money < upgrade.money) {
      alert(`ëˆì´ ë¶€ì¡±í•©ë‹ˆë‹¤. í•„ìš” ê¸ˆì•¡: ${upgrade.money}`);
      return;
    }

    money -= upgrade.money;
    MAX_DURABILITY += upgrade.durabilityAddition;
    durability = MAX_DURABILITY;
    currentDurabilityLevel++;

    updateUI();
    alert(`ë‚´êµ¬ë„ +${upgrade.durabilityAddition}! í˜„ì¬ ë‚´êµ¬ë„: ${MAX_DURABILITY}`);
  }

  drill.addEventListener("click", dropDrill);

  createGround();
  updateUI();
</script>

</body>
</html>
